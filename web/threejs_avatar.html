<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three.js Human Avatar</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        
        #controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }
        
        .control-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        
        select, input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        
        button:hover {
            background: #5a6fd8;
        }
        
        #info {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
            max-width: 300px;
        }
    </style>
</head>
<body>
    <div id="controls">
        <h3>Avatar Customization</h3>
        
        <div class="control-group">
            <label for="gender">Gender:</label>
            <select id="gender">
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="bodyType">Body Type:</label>
            <select id="bodyType">
                <option value="slim">Slim</option>
                <option value="athletic">Athletic</option>
                <option value="muscular">Muscular</option>
                <option value="curvy">Curvy</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="faceType">Face Type:</label>
            <select id="faceType">
                <option value="oval">Oval</option>
                <option value="round">Round</option>
                <option value="square">Square</option>
                <option value="heart">Heart</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="hairColor">Hair Color:</label>
            <select id="hairColor">
                <option value="black">Black</option>
                <option value="brown">Brown</option>
                <option value="blonde">Blonde</option>
                <option value="red">Red</option>
                <option value="gray">Gray</option>
                <option value="white">White</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="eyeColor">Eye Color:</label>
            <select id="eyeColor">
                <option value="brown">Brown</option>
                <option value="blue">Blue</option>
                <option value="green">Green</option>
                <option value="hazel">Hazel</option>
                <option value="gray">Gray</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="skinTone">Skin Tone:</label>
            <select id="skinTone">
                <option value="light">Light</option>
                <option value="medium">Medium</option>
                <option value="olive">Olive</option>
                <option value="tan">Tan</option>
                <option value="dark">Dark</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="style">Style:</label>
            <select id="style">
                <option value="professional">Professional</option>
                <option value="casual">Casual</option>
                <option value="sporty">Sporty</option>
                <option value="elegant">Elegant</option>
                <option value="artistic">Artistic</option>
            </select>
        </div>
        
        <div class="control-group">
            <label>
                <input type="checkbox" id="hasBeard"> Has Beard
            </label>
        </div>
        
        <div class="control-group">
            <label>
                <input type="checkbox" id="hasGlasses"> Has Glasses
            </label>
        </div>
        
        <button onclick="updateAvatar()">Update Avatar</button>
    </div>
    
    <div id="info">
        <h4>Controls:</h4>
        <p>• Left click + drag: Rotate view</p>
        <p>• Right click + drag: Pan view</p>
        <p>• Scroll: Zoom in/out</p>
        <p>• Use controls panel to customize avatar</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <script>
        let scene, camera, renderer, controls, avatar;
        
        // Initialize Three.js scene
        function init() {
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0xeceff1);
            
            // Camera
            camera = new THREE.PerspectiveCamera(
                75,
                window.innerWidth / window.innerHeight,
                0.1,
                1000
            );
            camera.position.set(0, 1.6, 5);
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            document.body.appendChild(renderer.domElement);
            
            // Lights
            const hemi = new THREE.HemisphereLight(0xffffff, 0x444444, 1.0);
            hemi.position.set(0, 2, 0);
            scene.add(hemi);
            
            const dir = new THREE.DirectionalLight(0xffffff, 0.8);
            dir.position.set(3, 10, 4);
            dir.castShadow = true;
            dir.shadow.mapSize.width = 2048;
            dir.shadow.mapSize.height = 2048;
            scene.add(dir);
            
            // Create initial avatar
            createAvatar();
            
            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.target.set(0, 1.2, 0);
            controls.update();
            
            // Animation
            animate();
            
            // Handle resize
            window.addEventListener('resize', onWindowResize);
        }
        
        // Create human avatar with specifications
        function createAvatar() {
            // Remove existing avatar
            if (avatar) {
                scene.remove(avatar);
            }
            
            avatar = new THREE.Group();
            
            // Get current values from controls
            const gender = document.getElementById('gender').value;
            const bodyType = document.getElementById('bodyType').value;
            const faceType = document.getElementById('faceType').value;
            const hairColor = document.getElementById('hairColor').value;
            const eyeColor = document.getElementById('eyeColor').value;
            const skinTone = document.getElementById('skinTone').value;
            const style = document.getElementById('style').value;
            const hasBeard = document.getElementById('hasBeard').checked;
            const hasGlasses = document.getElementById('hasGlasses').checked;
            
            // Get colors
            const skinColor = getSkinColor(skinTone);
            const clothingColor = getClothingColor(style);
            const hairColorHex = getHairColor(hairColor);
            const eyeColorHex = getEyeColor(eyeColor);
            
            // Create materials
            const skinMat = new THREE.MeshStandardMaterial({ color: skinColor });
            const clothMat = new THREE.MeshStandardMaterial({ color: clothingColor });
            const hairMat = new THREE.MeshStandardMaterial({ color: hairColorHex });
            const eyeMat = new THREE.MeshStandardMaterial({ color: eyeColorHex });
            
            // Calculate proportions
            const proportions = calculateProportions(bodyType, gender);
            
            // Create body parts
            createHead(faceType, skinMat, hairMat, eyeMat, hasBeard, hasGlasses, gender);
            createNeck(skinMat);
            createTriangularCollar(clothMat);
            createTorso(bodyType, gender, clothMat, proportions);
            createArms(bodyType, skinMat, clothMat, proportions);
            createLegs(bodyType, clothMat, proportions);
            createBelt(style);
            
            scene.add(avatar);
        }
        
        // Create head with face type
        function createHead(faceType, skinMat, hairMat, eyeMat, hasBeard, hasGlasses, gender) {
            let headGeo;
            
            switch (faceType.toLowerCase()) {
                case 'round':
                    headGeo = new THREE.SphereGeometry(0.3, 32, 32);
                    break;
                case 'square':
                    headGeo = new THREE.BoxGeometry(0.6, 0.6, 0.6);
                    break;
                case 'heart':
                    headGeo = new THREE.ConeGeometry(0.3, 0.6, 8);
                    break;
                default: // oval
                    headGeo = new THREE.SphereGeometry(0.3, 32, 16);
            }
            
            const head = new THREE.Mesh(headGeo, skinMat);
            head.position.set(0, 2.2, 0);
            head.castShadow = true;
            avatar.add(head);
            
            // Create hair
            createHair(gender, hairMat);
            
            // Create eyes
            createEyes(eyeMat);
            
            // Create glasses if needed
            if (hasGlasses) {
                createGlasses();
            }
            
            // Create beard if needed
            if (hasBeard && gender.toLowerCase() === 'male') {
                createBeard(hairMat);
            }
        }
        
        // Create hair based on gender
        function createHair(gender, hairMat) {
            if (gender.toLowerCase() === 'female') {
                // Female hair - longer and flowing
                const hairGeo = new THREE.SphereGeometry(0.35, 32, 16);
                const hair = new THREE.Mesh(hairGeo, hairMat);
                hair.position.set(0, 2.3, 0);
                hair.scale.set(1.2, 1.1, 1.2);
                hair.castShadow = true;
                avatar.add(hair);
            } else {
                // Male hair - shorter
                const hairGeo = new THREE.BoxGeometry(0.5, 0.2, 0.5);
                const hair = new THREE.Mesh(hairGeo, hairMat);
                hair.position.set(0, 2.4, 0);
                hair.castShadow = true;
                avatar.add(hair);
            }
        }
        
        // Create eyes
        function createEyes(eyeMat) {
            const eyeGeo = new THREE.SphereGeometry(0.05, 16, 16);
            
            // Left eye
            const leftEye = new THREE.Mesh(eyeGeo, eyeMat);
            leftEye.position.set(-0.15, 2.2, 0.25);
            avatar.add(leftEye);
            
            // Right eye
            const rightEye = leftEye.clone();
            rightEye.position.set(0.15, 2.2, 0.25);
            avatar.add(rightEye);
        }
        
        // Create glasses
        function createGlasses() {
            const glassMat = new THREE.MeshStandardMaterial({
                color: 0x333333,
                transparent: true,
                opacity: 0.3
            });
            
            const lensGeo = new THREE.SphereGeometry(0.12, 16, 16);
            
            // Left lens
            const leftLens = new THREE.Mesh(lensGeo, glassMat);
            leftLens.position.set(-0.15, 2.2, 0.26);
            avatar.add(leftLens);
            
            // Right lens
            const rightLens = leftLens.clone();
            rightLens.position.set(0.15, 2.2, 0.26);
            avatar.add(rightLens);
        }
        
        // Create beard
        function createBeard(hairMat) {
            const beardGeo = new THREE.BoxGeometry(0.4, 0.3, 0.2);
            const beard = new THREE.Mesh(beardGeo, hairMat);
            beard.position.set(0, 1.9, 0.2);
            beard.castShadow = true;
            avatar.add(beard);
        }
        
        // Create neck
        function createNeck(skinMat) {
            const neckGeo = new THREE.CylinderGeometry(0.15, 0.15, 0.3, 8);
            const neck = new THREE.Mesh(neckGeo, skinMat);
            neck.position.set(0, 1.7, 0);
            neck.castShadow = true;
            avatar.add(neck);
        }
        
        // Create triangular collar
        function createTriangularCollar(clothMat) {
            const triangleGeo = new THREE.ConeGeometry(0.8, 0.4, 3);
            const triangle = new THREE.Mesh(triangleGeo, clothMat);
            triangle.position.set(0, 1.5, 0);
            triangle.castShadow = true;
            avatar.add(triangle);
        }
        
        // Create torso
        function createTorso(bodyType, gender, clothMat, proportions) {
            const torsoGeo = new THREE.BoxGeometry(
                proportions.shoulderWidth,
                proportions.torsoHeight,
                proportions.torsoDepth
            );
            const torso = new THREE.Mesh(torsoGeo, clothMat);
            torso.position.set(0, 1.2, 0);
            torso.castShadow = true;
            avatar.add(torso);
        }
        
        // Create arms
        function createArms(bodyType, skinMat, clothMat, proportions) {
            // Upper arms
            const upperArmGeo = new THREE.CylinderGeometry(
                proportions.upperArmRadius,
                proportions.upperArmRadius,
                proportions.upperArmLength,
                8
            );
            
            // Left upper arm
            const leftUpperArm = new THREE.Mesh(upperArmGeo, skinMat);
            leftUpperArm.position.set(-proportions.shoulderWidth / 2 - 0.1, 1.2, 0);
            leftUpperArm.rotation.set(0, 0, 0.3);
            leftUpperArm.castShadow = true;
            avatar.add(leftUpperArm);
            
            // Right upper arm
            const rightUpperArm = leftUpperArm.clone();
            rightUpperArm.position.set(proportions.shoulderWidth / 2 + 0.1, 1.2, 0);
            rightUpperArm.rotation.set(0, 0, -0.3);
            avatar.add(rightUpperArm);
            
            // Lower arms
            const lowerArmGeo = new THREE.CylinderGeometry(
                proportions.lowerArmRadius,
                proportions.lowerArmRadius,
                proportions.lowerArmLength,
                8
            );
            
            // Left lower arm
            const leftLowerArm = new THREE.Mesh(lowerArmGeo, skinMat);
            leftLowerArm.position.set(-proportions.shoulderWidth / 2 - 0.3, 0.8, 0);
            leftLowerArm.rotation.set(0, 0, 0.3);
            leftLowerArm.castShadow = true;
            avatar.add(leftLowerArm);
            
            // Right lower arm
            const rightLowerArm = leftLowerArm.clone();
            rightLowerArm.position.set(proportions.shoulderWidth / 2 + 0.3, 0.8, 0);
            rightLowerArm.rotation.set(0, 0, -0.3);
            avatar.add(rightLowerArm);
            
            // Hands with half-sleeve effect
            createHands(skinMat, clothMat);
        }
        
        // Create hands with half-sleeve effect
        function createHands(skinMat, clothMat) {
            const handGeo = new THREE.SphereGeometry(0.08, 16, 16);
            
            // Left hand (skin part)
            const leftHand = new THREE.Mesh(handGeo, skinMat);
            leftHand.position.set(-0.6, 0.5, 0);
            leftHand.castShadow = true;
            avatar.add(leftHand);
            
            // Left sleeve cuff
            const sleeveGeo = new THREE.CylinderGeometry(0.1, 0.1, 0.1, 8);
            const leftSleeve = new THREE.Mesh(sleeveGeo, clothMat);
            leftSleeve.position.set(-0.6, 0.4, 0);
            leftSleeve.castShadow = true;
            avatar.add(leftSleeve);
            
            // Right hand (skin part)
            const rightHand = leftHand.clone();
            rightHand.position.set(0.6, 0.5, 0);
            avatar.add(rightHand);
            
            // Right sleeve cuff
            const rightSleeve = leftSleeve.clone();
            rightSleeve.position.set(0.6, 0.4, 0);
            avatar.add(rightSleeve);
        }
        
        // Create legs
        function createLegs(bodyType, clothMat, proportions) {
            // Thighs (thinner than waist)
            const thighGeo = new THREE.CylinderGeometry(
                proportions.thighRadius,
                proportions.thighRadius,
                proportions.thighLength,
                8
            );
            
            // Left thigh
            const leftThigh = new THREE.Mesh(thighGeo, clothMat);
            leftThigh.position.set(-0.25, 0.3, 0);
            leftThigh.castShadow = true;
            avatar.add(leftThigh);
            
            // Right thigh
            const rightThigh = leftThigh.clone();
            rightThigh.position.set(0.25, 0.3, 0);
            avatar.add(rightThigh);
            
            // Lower legs
            const lowerLegGeo = new THREE.CylinderGeometry(
                proportions.lowerLegRadius,
                proportions.lowerLegRadius,
                proportions.lowerLegLength,
                8
            );
            
            // Left lower leg
            const leftLowerLeg = new THREE.Mesh(lowerLegGeo, clothMat);
            leftLowerLeg.position.set(-0.25, -0.3, 0);
            leftLowerLeg.castShadow = true;
            avatar.add(leftLowerLeg);
            
            // Right lower leg
            const rightLowerLeg = leftLowerLeg.clone();
            rightLowerLeg.position.set(0.25, -0.3, 0);
            avatar.add(rightLowerLeg);
            
            // Feet
            const footGeo = new THREE.BoxGeometry(0.2, 0.1, 0.4);
            const footMat = new THREE.MeshStandardMaterial({ color: getShoeColor('casual') });
            
            // Left foot
            const leftFoot = new THREE.Mesh(footGeo, footMat);
            leftFoot.position.set(-0.25, -0.7, 0.1);
            leftFoot.castShadow = true;
            avatar.add(leftFoot);
            
            // Right foot
            const rightFoot = leftFoot.clone();
            rightFoot.position.set(0.25, -0.7, 0.1);
            avatar.add(rightFoot);
        }
        
        // Create belt
        function createBelt(style) {
            const beltMat = new THREE.MeshStandardMaterial({ color: getBeltColor(style) });
            const buckleMat = new THREE.MeshStandardMaterial({ color: getBuckleColor(style) });
            
            // Belt
            const beltGeo = new THREE.CylinderGeometry(0.6, 0.6, 0.1, 8);
            const belt = new THREE.Mesh(beltGeo, beltMat);
            belt.position.set(0, 0.6, 0);
            belt.castShadow = true;
            avatar.add(belt);
            
            // Buckle
            const buckleGeo = new THREE.BoxGeometry(0.15, 0.08, 0.05);
            const buckle = new THREE.Mesh(buckleGeo, buckleMat);
            buckle.position.set(0, 0.6, 0.35);
            buckle.castShadow = true;
            avatar.add(buckle);
        }
        
        // Calculate proportions based on body type
        function calculateProportions(bodyType, gender) {
            let proportions = {
                shoulderWidth: 1.0,
                torsoHeight: 1.2,
                torsoDepth: 0.5,
                upperArmRadius: 0.15,
                upperArmLength: 0.8,
                lowerArmRadius: 0.12,
                lowerArmLength: 0.6,
                thighRadius: 0.15, // Thinner than waist
                thighLength: 0.8,
                lowerLegRadius: 0.12,
                lowerLegLength: 0.8,
            };
            
            // Adjust for body type
            switch (bodyType.toLowerCase()) {
                case 'slim':
                    proportions.shoulderWidth = 0.8;
                    proportions.upperArmRadius = 0.12;
                    proportions.thighRadius = 0.12;
                    break;
                case 'athletic':
                    proportions.shoulderWidth = 1.1;
                    proportions.upperArmRadius = 0.18;
                    proportions.thighRadius = 0.18;
                    break;
                case 'muscular':
                    proportions.shoulderWidth = 1.2;
                    proportions.upperArmRadius = 0.2;
                    proportions.thighRadius = 0.2;
                    break;
                case 'curvy':
                    proportions.shoulderWidth = 1.0;
                    proportions.upperArmRadius = 0.16;
                    proportions.thighRadius = 0.18;
                    break;
            }
            
            // Gender adjustments
            if (gender.toLowerCase() === 'female') {
                proportions.shoulderWidth *= 0.9;
                proportions.thighRadius *= 1.1;
            }
            
            return proportions;
        }
        
        // Color helper functions
        function getSkinColor(skinTone) {
            const colors = {
                'light': 0xFFF5DEB3,
                'medium': 0xFFDEB887,
                'olive': 0xFFDAA520,
                'tan': 0xFFCD853F,
                'dark': 0xFFA0522D
            };
            return colors[skinTone] || 0xFFDEB887;
        }
        
        function getClothingColor(style) {
            const colors = {
                'professional': 0xFF2C3E50,
                'casual': 0xFF3498DB,
                'sporty': 0xFFE74C3C,
                'elegant': 0xFF1A1A1A,
                'artistic': 0xFF9B59B6
            };
            return colors[style] || 0xFF3498DB;
        }
        
        function getHairColor(hairColor) {
            const colors = {
                'black': 0xFF1A1A1A,
                'brown': 0xFF8B4513,
                'blonde': 0xFFDAA520,
                'red': 0xFFA0522D,
                'gray': 0xFF696969,
                'white': 0xFFF5F5F5
            };
            return colors[hairColor] || 0xFF8B4513;
        }
        
        function getEyeColor(eyeColor) {
            const colors = {
                'brown': 0xFF8B4513,
                'blue': 0xFF4169E1,
                'green': 0xFF228B22,
                'hazel': 0xFF8B7355,
                'gray': 0xFF708090
            };
            return colors[eyeColor] || 0xFF8B4513;
        }
        
        function getBeltColor(style) {
            const colors = {
                'professional': 0xFF1A1A1A,
                'casual': 0xFF8B4513,
                'sporty': 0xFF2C3E50,
                'elegant': 0xFF000000,
                'artistic': 0xFF6A1B9A
            };
            return colors[style] || 0xFF8B4513;
        }
        
        function getBuckleColor(style) {
            const colors = {
                'professional': 0xFFFFD700,
                'casual': 0xFFC0C0C0,
                'sporty': 0xFFFFFFFF,
                'elegant': 0xFFFFD700,
                'artistic': 0xFFF39C12
            };
            return colors[style] || 0xFFC0C0C0;
        }
        
        function getShoeColor(style) {
            const colors = {
                'professional': 0xFF1A1A1A,
                'casual': 0xFF8B4513,
                'sporty': 0xFFFFFFFF,
                'elegant': 0xFF000000,
                'artistic': 0xFF6A1B9A
            };
            return colors[style] || 0xFF8B4513;
        }
        
        // Update avatar
        function updateAvatar() {
            createAvatar();
        }
        
        // Animation loop
        function animate() {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        }
        
        // Handle window resize
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        // Initialize when page loads
        init();
    </script>
</body>
</html>
